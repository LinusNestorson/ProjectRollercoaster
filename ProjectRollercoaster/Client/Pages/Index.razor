@page "/"
@inject IFeedService FeedService
@inject IFeedContentService FeedContentService
@attribute [Authorize]

<PageTitle>Index</PageTitle>

<h1 class=indexHeader>Todays news</h1>
<div class="articleGrid">
    @foreach (var feed in FeedContentService.AllFeedContent)
    {
        <div class="indexArticle">
            <p>@feed.Title</p>
            <p>@feed.Summary</p>
            <p>@feed.PublishDate</p>
            @foreach (var link in feed.Links)
            {
                <a href=@link target="_blank">@link</a>
            }
        </div>
    }
</div>

@code {

    protected override async Task OnInitializedAsync()
    {
        await FeedService.LoadAllFeeds();

        foreach (var feed in FeedService.Feeds)
        {
            await FeedContentService.GetFeedContent();
        }
    }
}
